title: js闭包
date: 2017-03-24 14:03:53
tags:
---
js闭包，在我的理解来说主要就是在函数外部读取函数内部的变量。
由于js的‘链式作用域’，函数内部的值无法被外部读取。可是如果在某些情况下如果想在函数外部的值读取函数内部的值怎么办呢？这是就要用到闭包了。

	function a() {
		var n = 666;
		function b() {
			console.log(n)
		}
		return b();
	}
	a();
可以在console中看到打印出的666

这个是什么原理呢？

在函数a中又声明了一个函数b，那么照js的‘链式作用域’的规则就可以得出函数b可以读到函数a的内部的值。这是，在函数a中把函数b作为返回值返回出来，就可以在函数a的外部读取函数b，而函数b又可以读取到函数a中的值，因此，用这种方法就可以在函数a外部读取到函数b的值了。

但是要特别注意的是： 因为函数b被赋值给了一个全局变量，因此函数b会一直待在内存中，而函数a又是函数b的复函数，因此函数a也一直待在内存中。

##### 使用闭包的注意点

1）由于闭包会使得函数中的变量都被保存在内存中，内存消耗很大，所以不能滥用闭包，否则会造成网页的性能问题，在IE中可能导致内存泄露。解决方法是，在退出函数之前，将不使用的局部变量全部删除。

2）闭包会在父函数外部，改变父函数内部变量的值。所以，如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值。